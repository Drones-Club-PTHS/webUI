<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<title>Drenes club - Visit table</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<link rel="stylesheet" href="table/table.css">
	<script src="./github/store_github_logins.mjs"></script>
    <script>
		window.githubLogins.help();

        function saveChanges() {
			window.students.commit(true);
        }

		function addNewLesson() {
			let date = prompt("Lesson full date\n(example, \"01.01.2001\")\n");
			if (date) {
				window.tableGen.data.addNewLesson(date);
				window.tableGen.generateTableContent();
			}
		}

		function addNewStudent() {
			let id = prompt("\"Фамилия Имя\"\n");
			if (id) {
				window.tableGen.data.addStudent({id: id});
				window.tableGen.generateTableContent();
			}
		}
    </script>
</head>

<body>
	<button onclick="saveChanges()">Update Changes</button>
	<button onclick="addNewLesson()">New Lesson</button>
	<button onclick="addNewStudent()">New Student</button>
	<table id="visitTable" class="table"></table>
	<script type="module">
		import { GitHubFile } from "./github/github_files.mjs";
		import { StudentsData } from "./parse_data/students_data.js";
		import { TableGenerator } from "./table/tableGenerator.mjs";
		import { functions } from "./visit_table.mjs";
		
		
		window.students_file = new GitHubFile("students.json");
		window.students_file.fetch()
			.then(() => { window.students = new StudentsData(window.students_file.content) })
			.then(() => {
				window.tableGen = new TableGenerator(window.students, functions, document.getElementById("visitTable"));
				window.tableGen.generateTableContent();
			});
	</script>
</body>

</html>
