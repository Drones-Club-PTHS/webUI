<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<title>Drenes club - Visit table</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<link rel="stylesheet" href="../0_table/table.css">
    <script>
        function sendToGithub() {
			window.studentsFile.commit(true);
        }

		function addNewLesson() {
			let date = prompt("Lesson full date\n(example, \"01.01.2001\")\n");
			if (date) {
				window.tableGen.data.addNewLesson(date);
				window.tableGen.generateTableContent();
			}
		}

		function addNewStudent() {
			let id = prompt("\"Фамилия Имя\"\n");
			if (id) {
				window.tableGen.data.addStudent({id: id});
				window.tableGen.generateTableContent();
			}
		}
    </script>
</head>

<body>
	<button onclick="sendToGithub()" style="color: red;">Send to GitHub</button>
	<button onclick="window.tableGen.generateTableContent()">Rerender table</button>
	<button onclick="addNewLesson()">New Lesson</button>
	<button onclick="addNewStudent()">New Student</button>
	<table id="visitTable" class="table"></table>
	<script type="module">
		import { GitHubFile } from "../0_github/github_files.mjs";
		import { StudentsData } from "../0_parse_data/students_data.js";
		import { TableGenerator } from "../0_table/tableGenerator.mjs";
		import { functions } from "./visit_table.mjs";
		
		window.visitTable = document.getElementById("visitTable");
		window.studentsFile = new GitHubFile("students.json");
		window.students = new StudentsData(window.studentsFile);

		window.studentsFile.fetch()
			.then(() => {
				window.visitTable.tableGenerator = new TableGenerator(window.students, functions, document.getElementById("visitTable"));
				window.visitTable.tableGenerator.generateTableContent();
			});
	</script>
</body>

</html>
